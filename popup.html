<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      width: 320px;
      padding: 15px;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      font-size: 13px;
      background: #1e1e2e;
      color: #cdd6f4;
    }
    h1 {
      font-size: 18px;
      margin: 0 0 12px 0;
      color: #f5c2e7;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    h1::before {
      content: "üìö";
    }
    .status-card {
      background: #313244;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 12px;
    }
    .status-label {
      font-size: 11px;
      color: #6c7086;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
    }
    .status-value {
      font-size: 14px;
      color: #a6e3a1;
      font-weight: 500;
    }
    .status-value.inactive {
      color: #f9e2af;
    }
    .workspace-list {
      margin-top: 8px;
    }
    .workspace-item {
      display: inline-block;
      background: #45475a;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      margin: 2px 4px 2px 0;
      cursor: pointer;
      transition: background 0.15s;
    }
    .workspace-item:hover {
      background: #585b70;
    }
    .workspace-item.active {
      background: #89b4fa;
      color: #1e1e2e;
    }
    button.active {
      background: #89b4fa;
      color: #1e1e2e;
    }
    button.active:hover {
      background: #b4befe;
    }
    .button-group {
      display: flex;
      gap: 8px;
      margin-bottom: 12px;
    }
    button {
      flex: 1;
      padding: 10px 12px;
      border: none;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.15s, transform 0.1s;
    }
    button:hover {
      transform: translateY(-1px);
    }
    button:active {
      transform: translateY(0);
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    .btn-primary {
      background: #89b4fa;
      color: #1e1e2e;
    }
      .btn-primary:hover {
        background: #b4befe;
      }
    .btn-secondary {
      background: #45475a;
      color: #cdd6f4;
    }
    .btn-secondary:hover {
      background: #585b70;
    }
    .btn-warning {
      background: #f9e2af;
      color: #1e1e2e;
    }
    .btn-warning:hover {
      background: #f5c2e7;
    }
    .message {
      padding: 10px 12px;
      border-radius: 6px;
      font-size: 12px;
      margin-bottom: 12px;
      display: none;
    }
    .message.success {
      display: block;
      background: #a6e3a1;
      color: #1e1e2e;
    }
    .message.error {
      display: block;
      background: #f38ba8;
      color: #1e1e2e;
    }
    .info {
      font-size: 11px;
      color: #6c7086;
      line-height: 1.5;
      padding: 10px;
      background: #313244;
      border-radius: 6px;
    }
    .info strong {
      color: #cdd6f4;
    }
    .debug {
      font-size: 10px;
      color: #6c7086;
      line-height: 1.4;
      padding: 10px;
      background: #181825;
      border-radius: 6px;
      margin-top: 12px;
      font-family: 'Courier New', monospace;
      max-height: 200px;
      overflow-y: auto;
    }
    .debug-header {
      font-size: 11px;
      color: #f38ba8;
      font-weight: 600;
      margin-bottom: 6px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .debug-item {
      margin: 2px 0;
    }
    .debug-key {
      color: #89b4fa;
      display: inline-block;
      min-width: 140px;
    }
    .debug-value {
      color: #a6e3a1;
    }
    .debug-value.true {
      color: #a6e3a1;
    }
    .debug-value.false {
      color: #f38ba8;
    }
    .debug-value.null {
      color: #6c7086;
      font-style: italic;
    }
    .error-box {
      padding: 12px;
      border-radius: 6px;
      margin-bottom: 12px;
      background: #f38ba8;
      color: #1e1e2e;
      font-size: 12px;
      line-height: 1.5;
      display: none;
    }
    .error-box.show {
      display: block;
    }
    .error-box strong {
      display: block;
      margin-bottom: 4px;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <h1>Bookspace</h1>
  
  <div class="status-card">
    <div class="status-label">Current Workspace</div>
    <div id="current-workspace" class="status-value inactive">bookspace-none</div>
    <div id="workspace-list" class="workspace-list"></div>
    <div class="button-group" style="margin-top: 12px;">
      <button id="bookspace-none-btn" class="btn-secondary">bookspace-none</button>
      <button id="bookspace-all-btn" class="btn-secondary">bookspace-all</button>
    </div>
  </div>
  
  <div id="message" class="message"></div>
  
  <div id="error-box" class="error-box">
    <strong>‚ö†Ô∏è Workspace Detection Error</strong>
    <span id="error-message">Cannot determine current workspace state. This may be due to: (1) No containers available, (2) Container name does not match any bookspace folder, or (3) Bookspace folder not found. Ensure containers are created and attached to workspace tabs, and that container names match bookspace folder names. Check browser console for details.</span>
  </div>
  
  <div class="info">
    <strong>How it works:</strong><br>
    Create folders inside bookspace matching your workspace names. Attach Firefox containers to workspace tabs with names matching your bookspace folders. The extension automatically detects workspaces from container names. You can also manually switch workspaces by clicking workspace names.
  </div>
  
  <div class="debug">
    <div class="debug-header">üîç Debug State</div>
    <div id="debug-content"></div>
  </div>
  
  <script src="popup.js"></script>
</body>
</html>
